(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{238:function(t,e,a){},239:function(t,e,a){},81:function(t,e,a){t.exports=a(82)},82:function(t,e,a){"use strict";a.r(e);var n=a(80),r=a(46),o=a.n(r),s=a(72),i=a(34),l=a(47),c=a(36),u=a(35),p=a(37),d=a(1),h=a.n(d),m=a(22),g=a.n(m),b=a(73),f=a(49),C=a(78),E=a.n(C),v=a(79),y=a.n(v),S=(a(237),a(238),a(239),{labels:[],datasets:[{label:"Datapoints",fill:!0,lineTension:.1,backgroundColor:"rgba(75,192,192,0.4)",borderColor:"rgba(75,192,192,1)",borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",pointBorderColor:"rgba(75,192,192,1)",pointBackgroundColor:"#fff",pointBorderWidth:1,pointHoverRadius:5,pointHoverBackgroundColor:"rgba(75,192,192,1)",pointHoverBorderColor:"rgba(220,220,220,1)",pointHoverBorderWidth:2,pointRadius:1,pointHitRadius:10,data:[]}]}),O=function(t){return t.current?{query:{filter:{propertyFilter:{op:"GREATER_THAN_OR_EQUAL",property:{name:"published_at"},value:{stringValue:t.startTime.toISOString()}}},kind:[{name:"ParticleEvent"}],projection:[{property:{name:"data"}},{property:{name:"published_at"}}]}}:{query:{filter:{compositeFilter:{filters:[{propertyFilter:{op:"GREATER_THAN_OR_EQUAL",property:{name:"published_at"},value:{stringValue:t.startTime.toISOString()}}},{propertyFilter:{op:"LESS_THAN_OR_EQUAL",property:{name:"published_at"},value:{stringValue:t.endTime.toISOString()}}}],op:"AND"}},kind:[{name:"ParticleEvent"}],projection:[{property:{name:"data"}},{property:{name:"published_at"}}]}}},j=function(t){function e(t){var a;return Object(i.a)(this,e),(a=Object(c.a)(this,Object(u.a)(e).call(this,t))).handleChangeStart=function(t){a.setState({startTime:t})},a.handleChangeEnd=function(t){a.setState({endTime:t})},a.handleCurrent=function(t){t.target.checked?(a.setState({current:!0,endTime:null}),a.interval=setInterval(function(){return a.getData()},1500)):(a.setState({current:!1}),clearInterval(a.interval),a.handleChangeEnd(new Date))},a.getDataHandler=Object(s.a)(o.a.mark(function t(){var e;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e=O(a.state),null!==a.lastCursor&&(e.query.startCursor=a.lastCursor),t.next=4,fetch("https://datastore.googleapis.com/v1/projects/ubc-supermileage-telemetry-v2:runQuery?prettyPrint=true&alt=json",{method:"POST",headers:{Authorization:"Bearer "+a.token,Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(e)}).then(function(t){return t.json().then(function(t){return"entityResults"in t.batch&&(null===a.lastCursor?(a.x=[],a.y=[],a.indx=0):(a.x=a.x.slice(),a.y=a.y.slice()),t.batch.entityResults.forEach(function(t){a.x.push(parseInt(t.entity.properties.data.stringValue)),a.y.push(a.indx),a.indx++})),"NOT_FINISHED"===t.batch.moreResults?(a.lastCursor=t.batch.endCursor,a.getDataHandler()):(a.lastCursor=null,!0)})});case 4:case"end":return t.stop()}},t,this)})),a.getData=function(){a.getDataHandler().then(function(){var t=a.state.graph.datasets[0],e=Object(n.a)({},t);e.data=a.x,a.setState({graph:{labels:a.y,datasets:[e]}})})},a.responseGoogle=function(t){a.setState({loggedIn:!0}),console.log(t),console.log("Success"),a.token=t.accessToken},a.responseFail=function(t){console.log(t),console.log("Failed")},a.buttonInit=function(){return h.a.createElement("span",{className:"updateButton"},h.a.createElement("button",{onClick:a.getData},"Update"))},a.lastCursor=null,a.x=[],a.y=[],a.indx=0,a.state={startTime:new Date,endTime:new Date,current:!1,loggedIn:!1,graph:S,animations:!0},a}return Object(p.a)(e,t),Object(l.a)(e,[{key:"render",value:function(){return this.state.loggedIn?h.a.createElement("div",null,h.a.createElement("div",{className:"header"},h.a.createElement(k,{startVal:this.state.startTime,endVal:this.state.endTime,onChangeStart:this.handleChangeStart,onChangeEnd:this.handleChangeEnd}),h.a.createElement("label",{className:"toggle"},h.a.createElement(E.a,{defaultChecked:this.state.current,onChange:this.handleCurrent})),this.state.current?"":this.buttonInit()),h.a.createElement(T,{data:this.state.graph,animations:this.state.animations})):h.a.createElement("div",{className:"login"},h.a.createElement(y.a,{clientId:"617338661646-v92ol8vhd4nl44vpntkv4jpjbq5hahmo.apps.googleusercontent.com",buttonText:"Login",onSuccess:this.responseGoogle,onFailure:this.responseFail}))}}]),e}(h.a.Component),T=function(t){function e(t){var a;return Object(i.a)(this,e),(a=Object(c.a)(this,Object(u.a)(e).call(this,t))).render=function(){return h.a.createElement("div",null,h.a.createElement(b.a,{data:a.props.data,options:{animation:!!a.props.animations&&{duration:500}}}))},a.val=1,a}return Object(p.a)(e,t),e}(h.a.Component),k=function(t){function e(){return Object(i.a)(this,e),Object(c.a)(this,Object(u.a)(e).apply(this,arguments))}return Object(p.a)(e,t),Object(l.a)(e,[{key:"render",value:function(){return h.a.createElement("div",{id:"pickers"}," Start "," ",h.a.createElement(f.a,{selected:this.props.startVal,selectsStart:!0,showTimeSelect:!0,timeIntervals:2,startDate:this.props.startVal,endDate:this.props.endVal,onChange:this.props.onChangeStart,dateFormat:"MMMM d h:mm:ss aa"})," End ",h.a.createElement(f.a,{selected:this.props.endVal,placeholderText:"Current",selectsEnd:!0,showTimeSelect:!0,timeIntervals:2,startDate:this.props.startVal,endDate:this.props.endVal,onChange:this.props.onChangeEnd,dateFormat:"MMMM d h:mm:ss aa"}))}}]),e}(h.a.Component);g.a.render(h.a.createElement(j,null),document.getElementById("root"))}},[[81,1,2]]]);
//# sourceMappingURL=main.923f80c9.chunk.js.map