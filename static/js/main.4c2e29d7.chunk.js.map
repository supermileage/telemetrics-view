{"version":3,"sources":["constants.js","index.js"],"names":["data","datasets","spanGaps","showLine","label","yAxisID","fill","lineTension","backgroundColor","borderColor","borderCapStyle","borderDash","borderDashOffset","borderJoinStyle","pointBorderColor","pointBackgroundColor","pointBorderWidth","pointHoverRadius","pointHoverBackgroundColor","pointHoverBorderColor","pointHoverBorderWidth","pointRadius","pointHitRadius","chartOptions","animation","duration","scales","xAxes","gridLines","display","type","distribution","scaleLabel","labelString","yAxes","id","position","request","state","current","query","filter","compositeFilter","filters","propertyFilter","op","property","name","value","stringValue","startTime","toISOString","kind","projection","endTime","shortcuts","Today","moment","Yesterday","subtract","GraphContainer","props","_this","Object","classCallCheck","this","possibleConstructorReturn","getPrototypeOf","call","handleChangeStart","time","setState","handleChangeEnd","handleCurrent","e","target","checked","intervalHandler","clearTimeout","timeout","asyncToGenerator","regenerator_default","a","mark","_callee","wrap","_context","prev","next","getData","console","log","setTimeout","stop","getDataHandler","_ref2","_callee2","mode","req","_context2","lastCursor","startCursor","fetch","method","headers","Authorization","token","Accept","Content-Type","body","JSON","stringify","then","val","json","batch","vals","entityResults","forEach","d","retVals","entity","properties","split","i","elem","y","parseFloat","x","published_at","length","unix","push","NaN","NMEASeq","lat","parseInt","lng","moreResults","endCursor","error","_x","_x2","apply","arguments","_callee3","newData","_context3","updating","toConsumableArray","graph","chartRef","_meta","hidden","coordinates","slice","responseGoogle","response","loggedIn","accessToken","responseFail","buttonProvider","react_default","createElement","className","onClick","disabled","infoHide","infoOn","getChartRef","ref","header","undefined","src_DayRange","startVal","endVal","onChangeStart","onChangeEnd","component_default","defaultChecked","onChange","src_Graph","src_Map","google_login_default","clientId","buttonText","onSuccess","onFailure","React","Component","Graph","shouldComponentUpdate","nextProps","_this2","render","es","options","Map","_this3","initMap","map","window","google","maps","document","getElementById","center","zoom","loaded","drawLineOnMap","panTo","LatLng","Math","floor","lines","Polyline","path","setMap","setPath","componentWillMount","tag","async","src","appendChild","DayRange","rc_datetime_picker_cjs","format","readOnly","ReactDOM","src_GraphContainer"],"mappings":"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","file":"static/js/main.4c2e29d7.chunk.js","sourcesContent":["import moment from 'moment';\r\n\r\nexport const data = {\r\n    datasets: [\r\n        {\r\n            spanGaps: false,\r\n            showLine: true,\r\n            label: 'Temperature 1',\r\n            yAxisID: 'Temperature',\r\n            fill: true,\r\n            lineTension: 0.1,\r\n            backgroundColor: 'rgba(75,192,192,0.4)',\r\n            borderColor: 'rgba(75,192,192,1)',\r\n            borderCapStyle: 'butt',\r\n            borderDash: [],\r\n            borderDashOffset: 0.0,\r\n            borderJoinStyle: 'miter',\r\n            pointBorderColor: 'rgba(75,192,192,1)',\r\n            pointBackgroundColor: '#fff',\r\n            pointBorderWidth: 1,\r\n            pointHoverRadius: 5,\r\n            pointHoverBackgroundColor: 'rgba(75,192,192,1)',\r\n            pointHoverBorderColor: 'rgba(220,220,220,1)',\r\n            pointHoverBorderWidth: 2,\r\n            pointRadius: 1,\r\n            pointHitRadius: 10,\r\n            data: [] // Data to update\r\n        },\r\n        {\r\n            spanGaps: false,\r\n            showLine: true,\r\n            label: 'Temperature 2',\r\n            yAxisID: 'Temperature',\r\n            fill: true,\r\n            lineTension: 0.1,\r\n            backgroundColor: 'rgba(75,192,192,0.4)',\r\n            borderColor: 'rgba(75,192,192,1)',\r\n            borderCapStyle: 'butt',\r\n            borderDash: [],\r\n            borderDashOffset: 0.0,\r\n            borderJoinStyle: 'miter',\r\n            pointBorderColor: 'rgba(75,192,192,1)',\r\n            pointBackgroundColor: '#fff',\r\n            pointBorderWidth: 1,\r\n            pointHoverRadius: 5,\r\n            pointHoverBackgroundColor: 'rgba(75,192,192,1)',\r\n            pointHoverBorderColor: 'rgba(220,220,220,1)',\r\n            pointHoverBorderWidth: 2,\r\n            pointRadius: 1,\r\n            pointHitRadius: 10,\r\n            data: [] // Data to update\r\n        },\r\n        {\r\n            spanGaps: false,\r\n            showLine: true,\r\n            label: 'State of Charge',\r\n            yAxisID: 'SOC',\r\n            fill: true,\r\n            lineTension: 0.1,\r\n            backgroundColor: 'rgba(192,86,75,0.4)',\r\n            borderColor: 'rgba(192,86,75,1)',\r\n            borderCapStyle: 'butt',\r\n            borderDash: [],\r\n            borderDashOffset: 0.0,\r\n            borderJoinStyle: 'miter',\r\n            pointBorderColor: 'rgba(192,86,75,1)',\r\n            pointBackgroundColor: '#fff',\r\n            pointBorderWidth: 1,\r\n            pointHoverRadius: 5,\r\n            pointHoverBackgroundColor: 'rgba(192,86,75,1)',\r\n            pointHoverBorderColor: 'rgba(220,220,220,1)',\r\n            pointHoverBorderWidth: 2,\r\n            pointRadius: 1,\r\n            pointHitRadius: 10,\r\n            data: [] // Data to update\r\n        }\r\n    ],\r\n};\r\n\r\nexport const chartOptions = {\r\n    animation: {\r\n      duration : 500,\r\n    },\r\n    scales : {\r\n      xAxes: [{\r\n        gridLines: {\r\n          display: false,\r\n        },\r\n        type: 'time',\r\n        distribution: 'linear', // Distances can vary, based on time\r\n        scaleLabel: {\r\n          display: true,\r\n          labelString: 'Time'\r\n        },\r\n      }],\r\n      yAxes: [{\r\n        id: 'Temperature',\r\n        position: 'left',\r\n        gridLines: {\r\n          display: false,\r\n        },\r\n        scaleLabel: {\r\n          display: true,\r\n          labelString: 'Temperature'\r\n        },\r\n        },\r\n        {\r\n          id: 'SOC',\r\n          position: 'right',\r\n          gridLines: {\r\n            display: false,\r\n          },\r\n          scaleLabel: {\r\n            display: true,\r\n            labelString: 'State of Charge'\r\n          },\r\n        }\r\n    ]\r\n    },\r\n}\r\n  \r\nexport const request = (state, type) => {\r\nreturn (state.current) ? {\r\n    query: {\r\n        filter: {\r\n            compositeFilter: {\r\n                filters: [\r\n                {\r\n                    propertyFilter: {\r\n                        op: 'GREATER_THAN_OR_EQUAL',\r\n                        property: {\r\n                            name: 'published_at'\r\n                        },\r\n                        value: {\r\n                            stringValue: state.startTime.toISOString()\r\n                        }\r\n                    }\r\n                },\r\n                {\r\n                    propertyFilter: {\r\n                        op: 'EQUAL',\r\n                        property: {\r\n                            name: 'event'\r\n                        },\r\n                        value: {\r\n                            stringValue: type\r\n                        }\r\n                    }\r\n                }\r\n                ],\r\n                op: \"AND\"\r\n            }\r\n        },\r\n        kind: [\r\n            {\r\n                name: 'ParticleEvent'\r\n            }\r\n        ],\r\n        projection: [\r\n            {\r\n                property: {\r\n                    name: 'data'\r\n                }\r\n            },\r\n            {\r\n                property: {\r\n                    name: 'published_at'\r\n                }\r\n            }\r\n        ],\r\n    }\r\n    } : {\r\n    query: {\r\n        filter: {\r\n            compositeFilter: {\r\n                filters: [\r\n                {\r\n                    propertyFilter: {\r\n                        op: 'GREATER_THAN_OR_EQUAL',\r\n                        property: {\r\n                            name: 'published_at'\r\n                        },\r\n                        value: {\r\n                            stringValue: state.startTime.toISOString()\r\n                        }\r\n                    }\r\n                },\r\n                {\r\n                    propertyFilter: {\r\n                        op: 'LESS_THAN_OR_EQUAL',\r\n                        property: {\r\n                            name: 'published_at'\r\n                        },\r\n                        value: {\r\n                            stringValue: state.endTime.toISOString()\r\n                        }\r\n                    }\r\n                },\r\n                {\r\n                    propertyFilter: {\r\n                        op: 'EQUAL',\r\n                        property: {\r\n                            name: 'event'\r\n                        },\r\n                        value: {\r\n                            stringValue: type\r\n                        }\r\n                    }\r\n                }\r\n                ],\r\n                op: \"AND\"\r\n            }\r\n        }\r\n        ,\r\n        kind: [\r\n        {\r\n            name: \"ParticleEvent\"\r\n        }\r\n        ],\r\n        projection: [\r\n        {\r\n            property: {\r\n            name: \"data\"\r\n            }\r\n        },\r\n        {\r\n            property: {\r\n            name: \"published_at\"\r\n            }\r\n        }\r\n        ]\r\n    }\r\n}\r\n};\r\n\r\nexport const shortcuts = {\r\n    'Today': moment(),\r\n    'Yesterday': moment().subtract(1, 'days'),\r\n};","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport {Scatter} from 'react-chartjs-2';\r\nimport moment from 'moment';\r\nimport {DatetimePickerTrigger} from 'rc-datetime-picker';\r\nimport Toggle from 'react-toggle';\r\nimport GoogleLogin from 'react-google-login';\r\nimport {data, chartOptions, request, shortcuts} from './constants.js';\r\nimport './datetime.css';\r\nimport './toggle.css';\r\nimport './index.css';\r\nimport 'bulma/css/bulma.css';\r\n\r\n// Our graph container to hold all our objects, and also\r\n// to store state of our objects\r\nclass GraphContainer extends React.Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.lastCursor = null;\r\n    this.vals = [[], []];\r\n    this.chartRef = null;\r\n    this.state = {\r\n      startTime: moment(),\r\n      endTime: moment(),\r\n      current: false,\r\n      loggedIn: false,\r\n      graph: data,\r\n      updating: false,\r\n      infoOn: true,\r\n      coordinates: []\r\n    }\r\n  }\r\n\r\n  // Handle the start time change\r\n  handleChangeStart = (time) => {\r\n    this.setState({\r\n      startTime: time\r\n    })\r\n  }\r\n\r\n  // Handle the end time change\r\n  handleChangeEnd = (time) => {\r\n    this.setState({\r\n      endTime: time\r\n    })\r\n  }\r\n\r\n  // Handle the current boolean for \"live\" plotting\r\n  handleCurrent = (e) => {\r\n    let current = e.target.checked;\r\n    if (current) {\r\n      this.setState({\r\n        current: true,\r\n        endTime: null\r\n      })\r\n      this.intervalHandler();\r\n    } else {\r\n      clearTimeout(this.timeout);\r\n      this.setState({\r\n        current: false\r\n      })\r\n      this.handleChangeEnd(moment());\r\n    }\r\n  }\r\n\r\n  intervalHandler = async () => {\r\n    await this.getData();\r\n    console.log(\"get data done, resetting\");\r\n    if (this.state.current) {\r\n      this.timeout = setTimeout(this.intervalHandler, 2000);\r\n    }\r\n  }\r\n\r\n  // POST using OAuth creds to retrieve datastore based on time\r\n  // Async means it returns an implicit Promise that we will resolve later\r\n  getDataHandler = async (type, mode) => {\r\n    // Build our query\r\n    let req = request(this.state, type);\r\n\r\n    // Change our lastCursor value\r\n    if (this.lastCursor !== null) req.query.startCursor = this.lastCursor;\r\n    // Call our fetch\r\n    await fetch('https://datastore.googleapis.com/v1/projects/ubc-supermileage-telemetry-v2:runQuery?prettyPrint=true&alt=json', \r\n      {\r\n        method: 'POST',\r\n        headers: {\r\n          'Authorization' : 'Bearer ' + this.token,\r\n          'Accept': 'application/json',\r\n          'Content-Type': 'application/json',\r\n      },\r\n      body: JSON.stringify(req)}).then(val => val.json().then(e => {\r\n        // Try safety\r\n        console.log(e);\r\n        try {\r\n          if ('entityResults' in e.batch) {\r\n            console.log()\r\n            if (this.lastCursor === null) {\r\n              this.vals = [[], []];\r\n            }\r\n            e.batch.entityResults.forEach(d => {\r\n              // For a coordinate\r\n              if (mode === 0) {\r\n                let retVals = d.entity.properties.data.stringValue.split(\" \");\r\n                for (let i = 0; i < 2; i++) {\r\n                  let elem = {};\r\n                  elem.y = parseFloat(retVals[i]);\r\n                  elem.x = moment(d.entity.properties.published_at.stringValue);\r\n                  // Check if the last element was greater than 10 minutes ago\r\n                  if (this.vals[i].length > 0 && elem.x.unix() \r\n                        - moment(this.vals[i][this.vals[i].length - 1].x).unix() > 600) {\r\n                    this.vals[i].push({\r\n                      y: NaN,\r\n                      x: elem.x\r\n                    });\r\n                  }\r\n                  this.vals[i].push(elem);\r\n                }\r\n              } else {\r\n                // Convert to lat/long here\r\n                // Sample NMEA seq \"$GPRMC,033404.000,A,4915.6993,N,12314.9440,W,0.45,107.40,060319,,,A*72\", \r\n                let NMEASeq = d.entity.properties.data.stringValue.split(',');\r\n                let lat = parseInt(parseInt(NMEASeq[3]) / 100) + parseFloat(parseFloat(NMEASeq[3]) % 100) / 60;\r\n                let lng = parseInt(parseInt(NMEASeq[5]) / 100) + parseFloat(parseFloat(NMEASeq[5]) % 100) / 60;\r\n                lat = (NMEASeq[4] === \"S\") ? -lat : lat;\r\n                lng = (NMEASeq[6] === \"W\") ? -lng : lng;\r\n                let elem = {};\r\n                elem.lat = lat;\r\n                elem.lng = lng;\r\n                this.vals[0].push(elem);\r\n              }\r\n            });\r\n          } else {\r\n            // Clear our values\r\n            this.vals = [[], []];\r\n          }\r\n          if (e.batch.moreResults === \"NOT_FINISHED\") {\r\n            console.log(\"Not done\");\r\n            this.lastCursor = e.batch.endCursor;\r\n            return this.getDataHandler(type, mode);\r\n          }\r\n        } catch (error) {\r\n          console.log(error);\r\n        }\r\n        console.log(\"Done\");\r\n        this.lastCursor = null;\r\n        return true;\r\n      }));\r\n  }\r\n\r\n  // Handler for our data, which sets up a promise \r\n  // that updates once our data has been set up\r\n  getData = async () => {\r\n    this.setState({\r\n      updating: true // Set updating to true so we render notice\r\n    });\r\n    let newData = [\r\n      ...this.state.graph.datasets, // Spread operator allows us to copy things\r\n    ];\r\n    // Get velocity\r\n    if (this.chartRef !== null && (this.chartRef.props.data.datasets[0]._meta[0].hidden !== true\r\n          || this.chartRef.props.data.datasets[1]._meta[0].hidden !== true)) {\r\n      await this.getDataHandler('Temperature', 0);\r\n      newData[0].data = this.vals[0];\r\n      newData[1].data = this.vals[1];\r\n    }\r\n    console.log(this.vals[0]);\r\n    console.log(this.vals[1]);\r\n    // Get power\r\n    if (this.chartRef !== null && this.chartRef.props.data.datasets[2]._meta[0].hidden !== true) {\r\n      await this.getDataHandler('Power', 0);\r\n      newData[2].data = this.vals[0];\r\n    }\r\n    // Get location\r\n    await this.getDataHandler('Location', 1);\r\n    // Parse location here\r\n    this.setState({\r\n      graph: {\r\n        datasets: newData\r\n      },\r\n      coordinates: this.vals[0].slice(),\r\n      updating: false // done updating\r\n    });\r\n  }\r\n\r\n  // OAuth authorized, do stuff\r\n  responseGoogle = (response) => {\r\n    this.setState({\r\n      loggedIn: true\r\n    });\r\n    console.log(response);\r\n    console.log(\"Success\");\r\n    this.token = response.accessToken;\r\n  }\r\n\r\n  // OAuth failed, don't do stuff\r\n  responseFail = (response) => {\r\n    console.log(response);\r\n    console.log(\"Failed\");\r\n  }\r\n\r\n  // This code sucks\r\n  buttonProvider = () => {\r\n    return (this.state.current) ? (<button \r\n      className=\"button is-rounded is-info is-small is-loading\" \r\n      onClick={this.getData} \r\n      disabled\r\n    >Update</button>) : (this.state.updating) ? (<button \r\n      className=\"button is-rounded is-info is-small is-loading\" \r\n      onClick={this.getData}\r\n      disabled\r\n    >Update</button>) : (<button \r\n      className=\"button is-rounded is-info is-small\" \r\n      onClick={this.getData} \r\n    >Update</button>);\r\n  }\r\n\r\n  infoHide = () => {\r\n    this.setState({\r\n      infoOn: false\r\n    });\r\n  }\r\n\r\n  getChartRef = (ref) => {\r\n    // Get reference to the chart \r\n    if (this.chartRef === null && ref !== null) {\r\n      this.chartRef = ref;\r\n    }\r\n  }\r\n\r\n  // Render element based on logged in state\r\n  render() {\r\n    const header = (<div className=\"container\"><div className=\"notification is-info\">Welcome! If it's your first time here,\r\n    the toggle sets whether the data is updated live. Otherwise, you can grab specific data by selecting \r\n    your time range, then pressing \"Update\". You may encounter errors if you're not authorized to access the \r\n    datastore. You can close this message on the top right.\r\n    <button onClick={this.infoHide} className=\"delete\"></button>\r\n    </div></div>);\r\n    if (!this.state.loggedIn) {\r\n      return (<div>\r\n      <div className=\"container notification is-link floater\">To get started, log in to generate an OAuth token.</div>\r\n      <div className=\"login\">\r\n        <GoogleLogin\r\n          clientId = \"617338661646-v92ol8vhd4nl44vpntkv4jpjbq5hahmo.apps.googleusercontent.com\"\r\n          buttonText = \"Login\"\r\n          onSuccess = {this.responseGoogle}\r\n          onFailure = {this.responseFail} \r\n        /></div></div>);\r\n    } else {\r\n      return (<div>\r\n      {(this.state.infoOn) ? header : undefined}\r\n      <div className=\"container notification\">\r\n        <div className=\"columns\">\r\n          <div className=\"column is-narrow\">\r\n            <DayRange\r\n              startVal = {this.state.startTime}\r\n              endVal = {this.state.endTime}\r\n              onChangeStart = {this.handleChangeStart}\r\n              onChangeEnd = {this.handleChangeEnd}\r\n            />\r\n          </div>\r\n          <div className=\"column\">\r\n            <div className=\"columns is-mobile\">\r\n              <div className=\"toggle column is-narrow\">\r\n                <Toggle\r\n                  defaultChecked = {this.state.current}\r\n                  onChange = {this.handleCurrent}\r\n                />\r\n              </div>\r\n              <div className=\"column is-narrow\">\r\n                {this.buttonProvider()}\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <div className=\"container notification has-background-white-bis\">\r\n        <Graph\r\n          data = {this.state.graph}\r\n          chartRef = {this.getChartRef}\r\n        />\r\n      </div>\r\n      <div className=\"container notification has-background-white-bis\">\r\n          <Map\r\n            coordinates = {this.state.coordinates}\r\n          />\r\n      </div>\r\n      </div>);\r\n    }\r\n  }\r\n}\r\n\r\n/**\r\n * Component that holds our graph object. \r\n */\r\nclass Graph extends React.Component {\r\n  // Flag to check whether the parent is grabbing values,\r\n  // if it isn't we don't update\r\n  shouldComponentUpdate = (nextProps) => {\r\n    return this.props.data !== nextProps.data;\r\n  }\r\n\r\n  render = () => {\r\n    console.log(\"Rerendering graph\");\r\n    return (<div>\r\n      <Scatter \r\n        data={this.props.data}\r\n        options={chartOptions}\r\n        ref={ref => this.props.chartRef(ref)}\r\n      />\r\n    </div>);\r\n  }\r\n}\r\n\r\n/**\r\n * Component that holds our Google map.\r\n */\r\nclass Map extends React.Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.lines = null;\r\n    this.state = {\r\n      map: null,\r\n      loaded: false\r\n    };\r\n  }\r\n\r\n  // Flag so that component doesn't update if we're \r\n  // currently updating the parent\r\n  shouldComponentUpdate = (nextProps) => {\r\n    return this.props.coordinates !== nextProps.coordinates;\r\n  }\r\n\r\n  initMap = () => {\r\n    let map = new window.google.maps.Map(document.getElementById('map'), {\r\n      center: {lat: 49.267941, lng: -123.247360},\r\n      zoom: 12\r\n    });\r\n    this.setState({\r\n      map: map,\r\n      loaded: true\r\n    });\r\n  }\r\n\r\n  drawLineOnMap = () => {\r\n    // If there were valid coordinates, do stuff\r\n    if (this.props.coordinates.length > 0) {\r\n      console.log(\"Drawing lines\");\r\n      // Center around first element\r\n      this.state.map.panTo(new window.google.maps.LatLng(\r\n        this.props.coordinates[Math.floor(this.props.coordinates.length / 2)].lat, \r\n        this.props.coordinates[Math.floor(this.props.coordinates.length / 2)].lng));\r\n      // If no line initialized, initialize it \r\n      if (this.lines === null) {\r\n        // Set the state\r\n        this.lines = new window.google.maps.Polyline({\r\n                    path: this.props.coordinates, // This is just an array of coordinates\r\n                    map: this.state.map\r\n                  });\r\n      } else {\r\n        this.lines.setMap(this.state.map);\r\n        this.lines.setPath(this.props.coordinates);\r\n      }\r\n    } else {\r\n      // Clear the map property from the line\r\n      if (this.lines !== null) {\r\n        this.lines.setMap(null);\r\n      }\r\n    }\r\n  }\r\n  \r\n  // Load the Google map script when this component mounts\r\n  componentWillMount = () => {\r\n    window.initMap = this.initMap;\r\n    let tag = document.createElement(\"script\");\r\n    tag.async = true;\r\n    // Loads only from specific endpoints, safe to commit\r\n    tag.src = \"https://maps.googleapis.com/maps/api/js?key=AIzaSyCwcnq2MMCPKEY3hQigIBJn70buQH9py3E&callback=initMap\";\r\n    // Append the script\r\n    document.body.appendChild(tag);\r\n  }\r\n\r\n  render = () => {\r\n    console.log(\"Rerendering map\");\r\n    if (this.state.loaded) {\r\n      this.drawLineOnMap();\r\n    }\r\n    return (\r\n      <div id=\"map\"></div>\r\n    );\r\n  }\r\n}\r\n\r\n\r\nclass DayRange extends React.Component {\r\n  // Render my pickers; all the state is lifted up into \r\n  // the parent element, thus all the changes are handled\r\n  // by props; this element does not have state\r\n  render() {\r\n    return (<div className=\"columns\">\r\n        <div className=\"column\">\r\n          <DatetimePickerTrigger\r\n            className = \"input is-rounded is-small\"\r\n            shortcuts = {shortcuts}\r\n            moment = {this.props.startVal}\r\n            onChange = {this.props.onChangeStart}>\r\n            <input type=\"text\" value={this.props.startVal.format('YYYY-MM-DD HH:mm')} readOnly />\r\n          </DatetimePickerTrigger>\r\n          </div>\r\n        <div className=\"column\">\r\n          <DatetimePickerTrigger\r\n            className = \"input is-rounded is-small\"\r\n            shortcuts = {shortcuts}\r\n            moment = {this.props.endVal}\r\n            onChange = {this.props.onChangeEnd}\r\n            disabled = {(this.props.endVal === null) ? true : false}>\r\n            <input \r\n              type = \"text\" \r\n              value = {(this.props.endVal === null) ?\r\n                \"Current\" : this.props.endVal.format('YYYY-MM-DD HH:mm')} \r\n              readOnly\r\n              disabled = {(this.props.endVal === null) ? true : false}\r\n            />\r\n          </DatetimePickerTrigger>\r\n        </div>\r\n      </div>);\r\n  }\r\n}\r\n\r\n// ========================================\r\n\r\nReactDOM.render(\r\n  <GraphContainer />,\r\n  document.getElementById('root')\r\n);"],"sourceRoot":""}