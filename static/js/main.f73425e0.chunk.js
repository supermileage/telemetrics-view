(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{240:function(t,e,a){},241:function(t,e,a){},242:function(t,e,a){},74:function(t,e,a){t.exports=a(75)},75:function(t,e,a){"use strict";a.r(e);var n=a(73),r=a(42),o=a.n(r),s=a(68),i=a(28),l=a(43),c=a(30),u=a(29),p=a(31),d=a(0),h=a.n(d),m=a(41),g=a.n(m),b=a(69),f=a(7),y=a.n(f),E=a(44),v=a(71),C=a.n(v),O=a(72),S=a.n(O),j=(a(240),a(241),a(242),{labels:[],datasets:[{label:"Datapoints",fill:!0,lineTension:.1,backgroundColor:"rgba(75,192,192,0.4)",borderColor:"rgba(75,192,192,1)",borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",pointBorderColor:"rgba(75,192,192,1)",pointBackgroundColor:"#fff",pointBorderWidth:1,pointHoverRadius:5,pointHoverBackgroundColor:"rgba(75,192,192,1)",pointHoverBorderColor:"rgba(220,220,220,1)",pointHoverBorderWidth:2,pointRadius:1,pointHitRadius:10,data:[]}]}),T=function(t){return t.current?{query:{filter:{propertyFilter:{op:"GREATER_THAN_OR_EQUAL",property:{name:"published_at"},value:{stringValue:t.startTime.toISOString()}}},kind:[{name:"ParticleEvent"}],projection:[{property:{name:"data"}},{property:{name:"published_at"}}]}}:{query:{filter:{compositeFilter:{filters:[{propertyFilter:{op:"GREATER_THAN_OR_EQUAL",property:{name:"published_at"},value:{stringValue:t.startTime.toISOString()}}},{propertyFilter:{op:"LESS_THAN_OR_EQUAL",property:{name:"published_at"},value:{stringValue:t.endTime.toISOString()}}}],op:"AND"}},kind:[{name:"ParticleEvent"}],projection:[{property:{name:"data"}},{property:{name:"published_at"}}]}}},k={Today:y()(),Yesterday:y()().subtract(1,"days")},D=function(t){function e(t){var a;return Object(i.a)(this,e),(a=Object(c.a)(this,Object(u.a)(e).call(this,t))).handleChangeStart=function(t){a.setState({startTime:t})},a.handleChangeEnd=function(t){a.setState({endTime:t})},a.handleCurrent=function(t){t.target.checked?(a.setState({current:!0,endTime:null}),a.interval=setInterval(function(){return a.getData()},1500)):(a.setState({current:!1}),clearInterval(a.interval),a.handleChangeEnd(y()()))},a.getDataHandler=Object(s.a)(o.a.mark(function t(){var e;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e=T(a.state),null!==a.lastCursor&&(e.query.startCursor=a.lastCursor),t.next=4,fetch("https://datastore.googleapis.com/v1/projects/ubc-supermileage-telemetry-v2:runQuery?prettyPrint=true&alt=json",{method:"POST",headers:{Authorization:"Bearer "+a.token,Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(e)}).then(function(t){return t.json().then(function(t){return"entityResults"in t.batch&&(null===a.lastCursor?(a.x=[],a.y=[],a.indx=0):(a.x=a.x.slice(),a.y=a.y.slice()),t.batch.entityResults.forEach(function(t){a.x.push(parseInt(t.entity.properties.data.stringValue)),a.y.push(a.indx),a.indx++})),"NOT_FINISHED"===t.batch.moreResults?(a.lastCursor=t.batch.endCursor,a.getDataHandler()):(a.lastCursor=null,!0)})});case 4:case"end":return t.stop()}},t,this)})),a.getData=function(){a.setState({updating:!0}),a.getDataHandler().then(function(){var t=a.state.graph.datasets[0],e=Object(n.a)({},t);e.data=a.x,a.setState({graph:{labels:a.y,datasets:[e]},updating:!1})})},a.responseGoogle=function(t){a.setState({loggedIn:!0}),console.log(t),console.log("Success"),a.token=t.accessToken},a.responseFail=function(t){console.log(t),console.log("Failed")},a.buttonInit=function(){return h.a.createElement("span",{className:"updateButton"},h.a.createElement("button",{onClick:a.getData},"Update"))},a.lastCursor=null,a.x=[],a.y=[],a.indx=0,a.state={startTime:y()(),endTime:y()(),current:!1,loggedIn:!1,graph:j,animations:!0,updating:!1},a}return Object(p.a)(e,t),Object(l.a)(e,[{key:"render",value:function(){return this.state.loggedIn?h.a.createElement("div",null,h.a.createElement("div",{className:"header"},h.a.createElement(H,{startVal:this.state.startTime,endVal:this.state.endTime,onChangeStart:this.handleChangeStart,onChangeEnd:this.handleChangeEnd}),h.a.createElement("label",{className:"toggle"},h.a.createElement(C.a,{defaultChecked:this.state.current,onChange:this.handleCurrent})),this.state.current?"":this.buttonInit(),this.state.updating?h.a.createElement("div",{className:"updating"},"Updating.."):""),h.a.createElement(x,{data:this.state.graph,animations:this.state.animations})):h.a.createElement("div",{className:"login"},h.a.createElement(S.a,{clientId:"617338661646-v92ol8vhd4nl44vpntkv4jpjbq5hahmo.apps.googleusercontent.com",buttonText:"Login",onSuccess:this.responseGoogle,onFailure:this.responseFail}))}}]),e}(h.a.Component),x=function(t){function e(){var t,a;Object(i.a)(this,e);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(c.a)(this,(t=Object(u.a)(e)).call.apply(t,[this].concat(r)))).render=function(){return h.a.createElement("div",null,h.a.createElement(b.a,{data:a.props.data,options:{animation:!!a.props.animations&&{duration:500}}}))},a}return Object(p.a)(e,t),e}(h.a.Component),H=function(t){function e(){return Object(i.a)(this,e),Object(c.a)(this,Object(u.a)(e).apply(this,arguments))}return Object(p.a)(e,t),Object(l.a)(e,[{key:"render",value:function(){return h.a.createElement("div",{className:"pickers"},h.a.createElement(E.DatetimePickerTrigger,{shortcuts:k,moment:this.props.startVal,onChange:this.props.onChangeStart},h.a.createElement("input",{type:"text",value:this.props.startVal.format("YYYY-MM-DD HH:mm"),readOnly:!0}))," - ",h.a.createElement(E.DatetimePickerTrigger,{shortcuts:k,moment:this.props.endVal,onChange:this.props.onChangeEnd,disabled:null===this.props.endVal},h.a.createElement("input",{type:"text",value:null===this.props.endVal?"Current":this.props.endVal.format("YYYY-MM-DD HH:mm"),readOnly:!0})))}}]),e}(h.a.Component);g.a.render(h.a.createElement(D,null),document.getElementById("root"))}},[[74,1,2]]]);
//# sourceMappingURL=main.f73425e0.chunk.js.map