(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{238:function(e,t,a){},239:function(e,t,a){},81:function(e,t,a){e.exports=a(82)},82:function(e,t,a){"use strict";a.r(t);var n=a(80),r=a(46),o=a.n(r),s=a(72),i=a(34),l=a(47),c=a(36),u=a(35),p=a(37),d=a(1),h=a.n(d),m=a(22),g=a.n(m),b=a(73),f=a(49),v=a(78),C=a.n(v),E=a(79),y=a.n(E),S=(a(237),a(238),a(239),{labels:[],datasets:[{label:"Datapoints",fill:!0,lineTension:.1,backgroundColor:"rgba(75,192,192,0.4)",borderColor:"rgba(75,192,192,1)",borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",pointBorderColor:"rgba(75,192,192,1)",pointBackgroundColor:"#fff",pointBorderWidth:1,pointHoverRadius:5,pointHoverBackgroundColor:"rgba(75,192,192,1)",pointHoverBorderColor:"rgba(220,220,220,1)",pointHoverBorderWidth:2,pointRadius:1,pointHitRadius:10,data:[]}]}),O=function(e){return e.current?{query:{filter:{propertyFilter:{op:"GREATER_THAN_OR_EQUAL",property:{name:"published_at"},value:{stringValue:e.startTime.toISOString()}}},kind:[{name:"ParticleEvent"}],projection:[{property:{name:"data"}},{property:{name:"published_at"}}]}}:{query:{filter:{compositeFilter:{filters:[{propertyFilter:{op:"GREATER_THAN_OR_EQUAL",property:{name:"published_at"},value:{stringValue:e.startTime.toISOString()}}},{propertyFilter:{op:"LESS_THAN_OR_EQUAL",property:{name:"published_at"},value:{stringValue:e.endTime.toISOString()}}}],op:"AND"}},kind:[{name:"ParticleEvent"}],projection:[{property:{name:"data"}},{property:{name:"published_at"}}]}}},j=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).handleChangeStart=function(e){a.setState({startTime:e})},a.handleChangeEnd=function(e){a.setState({endTime:e})},a.handleCurrent=function(e){console.log(e),e.target.checked?(a.setState({current:!0,endTime:null}),a.interval=setInterval(function(){return a.getData()},1500)):(a.setState({current:!1}),clearInterval(a.interval),a.handleChangeEnd(new Date))},a.getDataHandler=Object(s.a)(o.a.mark(function e(){var t;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=O(a.state),null!==a.lastCursor&&(t.query.startCursor=a.lastCursor),console.log(t),e.next=5,fetch("https://datastore.googleapis.com/v1/projects/ubc-supermileage-telemetry-v2:runQuery?prettyPrint=true&alt=json",{method:"POST",headers:{Authorization:"Bearer "+a.token,Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(t)}).then(function(e){return e.json().then(function(e){return"entityResults"in e.batch&&(null===a.lastCursor?(a.x=[],a.y=[],a.indx=0):(a.x=a.x.slice(),a.y=a.y.slice()),e.batch.entityResults.forEach(function(e){a.x.push(parseInt(e.entity.properties.data.stringValue)),a.y.push(a.indx),a.indx++})),"NOT_FINISHED"===e.batch.moreResults?(console.log("Not finished"),a.lastCursor=e.batch.endCursor,a.getDataHandler()):(console.log("Finished"),a.lastCursor=null,!0)})});case 5:case"end":return e.stop()}},e,this)})),a.getData=function(){a.getDataHandler().then(function(){console.log("resolved");var e=a.state.graph.datasets[0],t=Object(n.a)({},e);t.data=a.x,console.log("Set state"),console.log(a.state),a.setState({graph:{labels:a.y,datasets:[t]}})})},a.responseGoogle=function(e){a.setState({loggedIn:!0}),console.log(e),a.token=e.accessToken},a.responseFail=function(e){console.log(e),console.log("Failed")},a.buttonInit=function(){return h.a.createElement("span",{className:"updateButton"},h.a.createElement("button",{onClick:a.getData},"Update"))},a.lastCursor=null,a.x=[],a.y=[],a.indx=0,a.state={startTime:new Date,endTime:new Date,current:!1,loggedIn:!1,graph:S,animations:!0},a}return Object(p.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return this.state.loggedIn?h.a.createElement("div",null,h.a.createElement("div",{className:"header"},h.a.createElement(k,{startVal:this.state.startTime,endVal:this.state.endTime,onChangeStart:this.handleChangeStart,onChangeEnd:this.handleChangeEnd}),h.a.createElement("label",{className:"toggle"},h.a.createElement(C.a,{defaultChecked:this.state.current,onChange:this.handleCurrent})),this.state.current?"":this.buttonInit()),h.a.createElement(T,{data:this.state.graph,animations:this.state.animations})):h.a.createElement("div",{className:"login"},h.a.createElement(y.a,{clientId:"617338661646-v92ol8vhd4nl44vpntkv4jpjbq5hahmo.apps.googleusercontent.com",buttonText:"Login",onSuccess:this.responseGoogle,onFailure:this.responseFail}))}}]),t}(h.a.Component),T=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).render=function(){return h.a.createElement("div",null,h.a.createElement(b.a,{data:a.props.data,options:{animation:!!a.props.animations&&{duration:500}}}))},a.val=1,a}return Object(p.a)(t,e),t}(h.a.Component),k=function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return h.a.createElement("div",{id:"pickers"}," Start "," ",h.a.createElement(f.a,{selected:this.props.startVal,selectsStart:!0,showTimeSelect:!0,timeIntervals:2,startDate:this.props.startVal,endDate:this.props.endVal,onChange:this.props.onChangeStart,dateFormat:"MMMM d h:mm:ss aa"})," End ",h.a.createElement(f.a,{selected:this.props.endVal,placeholderText:"Current",selectsEnd:!0,showTimeSelect:!0,timeIntervals:2,startDate:this.props.startVal,endDate:this.props.endVal,onChange:this.props.onChangeEnd,dateFormat:"MMMM d h:mm:ss aa"}))}}]),t}(h.a.Component);g.a.render(h.a.createElement(j,null),document.getElementById("root"))}},[[81,1,2]]]);
//# sourceMappingURL=main.bdfe4885.chunk.js.map